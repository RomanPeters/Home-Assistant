apple_tv_airplay:
  alias: Apple TV AirPort Audio Output
  sequence:
    - alias: Wake up Apple TV
      service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - up

    - wait_template: "{{ not is_state('media_player.apple_tv', 'playing') and not is_state('media_player.apple_tv', 'off') }}"

    - alias: Open Settings
      service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - top_menu
          - down
          - down
          - down
          - right
          - right
          - right
          - up
          - up
          - select
          
    - alias: Go to Audio
      service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - down
          - down
          - down
          - down
          - down
          - down

    - delay:
        seconds: 1

    - alias: Select Audio
      service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - select

    - alias: Switch to AirPlay
      service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - down
          - down
          - down
          - down
          - down
          - down

    - delay:
        seconds: 1

    - alias: Confirm
      service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - select
          - top_menu
          - right
          - right
          - right

