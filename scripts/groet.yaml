alias: Announcement
sequence:
  - alias: Zet de tv aan
    service: homeassistant.turn_on
    data:
      entity_id: switch.g
  - delay:
      seconds: 50
  - alias: Connect Apple TV
    service: media_player.turn_on
    data:
      entity_id: media_player.apple_tv
  - service: tts.google_say
    data_template:
      entity_id: media_player.apple_tv
      message: >
        {% if now().strftime("%H")|int < 5 %}
         Goedenacht Roman.
        {% elif now().strftime("%H")|int < 12 %}
        Goedemorgen Roman.
        {% elif now().strftime("%H")|int < 18 %}
        Goedemiddag Roman.
        {% else %}
        Goedenavond Roman.
        {% endif %}

        Het is vandaag {{ now().strftime("%d") }} 
        {% if now().strftime("%-m")|int == 1 %}
        januari.
        {% elif now().strftime("%-m")|int == 2 %}
        februari.
        {% elif now().strftime("%-m")|int == 3 %}
        maart.
        {% elif now().strftime("%-m")|int == 4 %}
        april.
        {% elif now().strftime("%-m")|int == 5 %}
        mei.
        {% elif now().strftime("%-m")|int == 6 %}
        juni.
        {% elif now().strftime("%-m")|int == 7 %}
        juli.
        {% elif now().strftime("%-m")|int == 8 %}
        augustus.
        {% elif now().strftime("%-m")|int == 9 %}
        oktober.
        {% elif now().strftime("%-m")|int == 10 %}
        september.
        {% elif now().strftime("%-m")|int == 11 %}
        november.
        {% elif now().strftime("%-m")|int == 12 %}
        december.
        {% endif %}
        Het is momenteel {{ states.sensor.dark_sky_summary.state|lower }} en {{ states.sensor.dark_sky_temperature.state|round }} graden in Utrecht. 
        Verder {{ states.sensor.dark_sky_hourly_summary.state|replace(".", "")|lower }}, 
        met een minimale temperatuur van {{ states.sensor.dark_sky_daily_low_temperature.state|round }} en een maximale temperatuur van {{ states.sensor.dark_sky_daily_high_temperature.state|round }} graden.
                
        {% if now().strftime("%Y%m%d")|int == strptime(states.calendar.betaplanner.attributes.start_time, "%Y-%m-%d %H:%M:%S").strftime("%Y%m%d")|int %}
        Je hebt vandaag om {{ strptime(states.calendar.betaplanner.attributes.start_time, "%Y-%m-%d %H:%M:%S").strftime("%H:%M") }} uur
        {{ states.calendar.betaplanner.attributes.message[states.calendar.betaplanner.attributes.message.index('@')+2:]  }} 
        {{ states.calendar.betaplanner.attributes.message[:states.calendar.betaplanner.attributes.message.index('(')]  }} in {{ states.calendar.betaplanner.attributes.location }}.
        {% endif %}
      language: 'nl'
  - delay:
      seconds: 20
  - alias: Zet de tv uit
    service: homeassistant.turn_off
    data:
      entity_id: switch.g
 