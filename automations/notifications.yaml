# Boot
- id: notification_boot
  alias: Notification Boot
  trigger:
    - platform: homeassistant
      event: start
  action:
    - service: notify.notify
      data:
        message: "Home Assistant is online"
# iPhone Status
- id: notification_iphone_status
  alias: Notification iPhone Status
  trigger:
    - platform: state
      entity_id: sensor.iphone_8_battery_state
      from: Unplugged
    - platform: state
      entity_id: sensor.iphone_8_battery_state
      to: Unplugged
  action:
    - service: notify.notify
      data_template:
        message: "Your iPhone 8 is {{ states('sensor.iphone_8_battery_state') | lower }}."

# Alarm Clock
- id: notification_alarm_clock
  alias: 'Notification Alarm Clock'
  trigger:
    - platform: template
      value_template: "{{ states('sensor.time') == (states.input_datetime.alarm_clock.attributes.timestamp | int | timestamp_custom('%H:%M', False)) }}"
  condition:
    - condition: state
      entity_id: input_boolean.alarm_clock
      state: 'on'
    - condition: state
      entity_id: input_select.home_status
      state: 'Away'
  action:
    - service: notify.notify
      data:
        message: "Your alarm clock has been triggered!"

- id: notification_set_alarm_clock
  alias: 'Notification set Alarm Clock'
  trigger:
    - platform: state
      entity_id: input_select.home_status
      to: Night
      for:
        seconds: 3
  condition:
    - condition: state
      entity_id: input_boolean.alarm_clock
      state: 'on'
  action:
    - service: notify.notify
      data_template:
        message: "I'll wake you up at {{ states('input_datetime.alarm_clock')[:-3] }}"

# Device tracker
- id: notification_new_device
  alias: Notification New Device
  trigger:
    platform: event
    event_type: device_tracker_new_device
  action:
    - service: notify.notify
      data_template:
        message: >
          {{ trigger.event.data.host_name }}
        title: New device


# Low battery
- id: notification_low_battery
  alias: Notification Low Battery
  trigger:
    - platform: numeric_state
      entity_id: sensor.button     
      value_template: '{{ state.attributes.battery }}'
      below: 11
    - platform: numeric_state
      entity_id: sensor.illuminance
      value_template: '{{ state.attributes.battery }}'
      below: 11
    - platform: numeric_state
      entity_id: sensor.xiaomi_humidity    
      value_template: '{{ state.attributes.battery }}'
      below: 11
    - platform: numeric_state
      entity_id: sensor.wall_switch       
      value_template: '{{ state.attributes.battery }}'
      below: 11
    - platform: numeric_state
      entity_id: sensor.mi_flora_battery  
      below: 11
  action:
    - service: persistent_notification.create
      data_template:
        message: "{{ state_attr(trigger.entity_id, 'friendly_name') }} {{ trigger.entity_id.split('.')[0] }} is at {{ state_attr(trigger.entity_id, 'battery') | int }}% battery."
        title: "Battery warning"
