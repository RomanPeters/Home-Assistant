# LED
- id: coffee_led_on
  alias: LED on if coffee maker on
  trigger:
    - platform: state
      entity_id: switch.coffee_maker
      from: 'off'
      to: 'on'
  action:
    - service: light.turn_on
      entity_id: light.coffee_led
    - service: notify.notify
      data_template:
        message: "Your coffee will be ready at {{ now() }}"
    - service: timer.start
      entity_id: timer.make_coffee

- id: coffee_led_off
  alias: LED off if coffee maker off
  trigger:
    - platform: state
      entity_id: switch.coffee_maker    
      from: 'on'
      to: 'off'
  action:
    - service: light.turn_off
      entity_id: light.coffee_led
    - service: timer.cancel     
      entity_id: timer.make_coffee

# BUTTON
- id: coffee_button_on
  alias: Relay toggle on button
  trigger:
    - platform: state
      entity_id: binary_sensor.coffee_button
      from: 'off'
      to: 'on'
  action:
    - service: switch.toggle
      entity_id: switch.coffee_maker

# AUTO-OFF
- id: coffee_finished
  alias: Coffee finished
  trigger:      
    - platform: event
      event_type: timer.finished
      event_data: 
        entity_id: timer.make_coffee
  action:
    - service: switch.turn_off
      entity_id: switch.coffee_maker
    - service: notify.notify
      data:
        message: "Your coffee is done \u2615"
    - service: timer.start
      entity_id: timer.cool_coffee

- id: coffee_cooled
  alias: Coffee is at drinking temperature
  trigger: 
    - platform: event
      event_type: timer.finished
      event_data: 
        entity_id: timer.cool_coffee
  action:
    - service: notify.notify
      data:
        message: "Don't forget your coffee :)"
