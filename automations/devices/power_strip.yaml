# ENTONE ON
- id: entone_on
  alias: Turn Entone on
  trigger:
    - platform: state
      entity_id: switch.television
      to: 'on'
    - platform: state
      entity_id: input_select.tv_input
      to: 'Television'
  condition:
    - condition: state
      entity_id: input_select.tv_input
      state: 'Television'
  action:
    - service: switch.turn_on
      entity_id: switch.entone

# APPLE TV ON
- id: apple_tv_on
  alias: Turn Apple TV on
  trigger:
    - platform: state
      entity_id: switch.television
      to: 'on'
    - platform: state
      entity_id: input_select.tv_input
      to: 'Apple TV'
  condition:
    - condition: state
      entity_id: input_select.tv_input
      state: 'Apple TV'
    - condition: state
      entity_id: media_player.apple_tv
      state: 'off'
  action:
    - service: remote.send_command
      data:
        entity_id: remote.apple_tv
        command:
          - 'top_menu'

# ENTONE OFF
- id: entone_off
  alias: Turn Entone off when using other input
  trigger:
    - platform: state
      entity_id: switch.television
      to: 'off'
    - platform: state
      entity_id: input_select.tv_input
      to: 'Apple TV'
      for:
        minutes: 1
    - platform: state
      entity_id: input_select.tv_input
      to: 'HDMI'
      for:
        minutes: 1
  action:
    - service: switch.turn_off
      entity_id: switch.entone

# TV OFF
- id: tv_off_on_inactive_apple_tv
  alias: Turn TV off when not in use
  trigger:
    - platform: state
      entity_id: media_player.apple_tv
      to: 'idle'
      for:
        minutes: 10
  condition:
    - condition: state
      entity_id: input_select.tv_input
      state: 'Apple TV'
  action:
    - service: switch.turn_off
      entity_id: switch.television
